{% load static %}
{% block styles %}
<style>
.form-gradient .header {
  border-top-left-radius: .3rem;
  border-top-right-radius: .3rem; }

.form-gradient input[type=text]:focus:not([readonly]) {
  border-bottom: 1px solid #fd9267;
  box-shadow: 0 1px 0 0 #fd9267; }

.form-gradient input[type=text]:focus:not([readonly]) + label {
  color: #4f4f4f; }

.form-gradient textarea.md-textarea:focus:not([readonly]) {
    border-bottom: 1px solid #fd9267;
    box-shadow: 0 1px 0 0 #fd9267; }


.form-dark .md-form label {
  color: #fff; }

.form-dark input[type=text]:focus:not([readonly]) {
  border-bottom: 1px solid #00C851;
  -webkit-box-shadow: 0 1px 0 0 #00C851;
  box-shadow: 0 1px 0 0 #00C851; }

.form-dark input[type=text]:focus:not([readonly]) + label {
  color: #fff; }

.form-dark textarea.md-textarea:focus:not([readonly]) {
    border-bottom: 1px solid #00C851;
    box-shadow: 0 1px 0 0 #00C851;
    color: #fff; }

.form-dark textarea.md-textarea  {
    color: #fff;
}

.form-dark .form-control, .form-dark .form-control:focus {
    color: #fff;
}
</style>
{% endblock %}

{% block content %}
    <!-- 聊天即時訊息(id, time) -->
    <div class="list-group col-md-10 col-md-offset-1 well">
        <div class="list-group-item">
            {% for chat in Friends_Chat %}
                <h4 class="list-group-item-heading">{{chat.memberId}}:{{chat.message}}</h4>
                <p class="list-group-item-text">{{chat.messageUpdate}}</p>
                <input type="hidden" class="chat_id" value="{{chat.id}}"/>
                <br>
            {% endfor %}
        </div>
    </div>

    <!-- 交友聊天室 -->
    <div class="card card-image" style="background-image: url('https://mdbootstrap.com/img/Photos/Others/pricing-table%20(7).jpg');"
        method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="text-white rgba-stylish-strong py-5 px-5 z-depth-4">
            <!--Header-->
            <div class="text-center">
                <h3 class="white-text mb-5 mt-4 font-weight-bold text-uppercase"><strong>Make</strong> <a class="green-text font-weight-bold" href="https://www.facebook.com"><strong>Friends</strong></a></h3>
            </div>
            <!-- <div class="md-form">
                <textarea type="text" name="message" id="message" class="md-textarea form-control" rows="20" placeholder=""></textarea>
                <label for="message">Chat Room</label>
            </div> -->
            <input type="text" name="inputuser" placeholder="user message" maxlength="100" size="30">|
            <div class="row d-flex align-items-center">
                <!--Grid column-->
                <div class="text-center col-md-12 mt-3 mb-2">
                    <button type="button" name="send" id="btn1" class="btn btn-success btn-block btn-rounded z-depth-1">Send</button>
                <img id="img1" src="{% static "images/ajax-loader.gif" %}" style="display:none" />
                <input type="button" name="clear" class="btn btn-success btn-block btn-rounded z-depth-1" id="btn2" value="delete">
                {% for friends in Friends_Chat %}
                    <a href="{% url "friends:all" %}" class="btn btn-danger"><i class="far fa-comment"></i></a>
                {% endfor %}
                </div>
            </div>
        </div>
    </div>
{% endblock %} 

{% block scripts %}
<script>
    $(document).ready(function(){

        // jquery send message
        $('#btn1').click(function(){
            var userid = $('').val();
            var message = $('input[type="text"]').val();
            var messageUpdate = $('').val();
            // 抓取對話訊息
            $.get('/send/'+ userid +'/',        
               {"memberID":userid,"message":message,"messageUpdate":messageUpdate},   
            function(datas){
                $('#message').html("<h4>"+ datas +"</h4>"+ "<br>");
            // 傳給python函式寫進資料庫
            $.post('/message/'+ userid +'/',  
               {"memberID":userid,"message":message,"messageUpdate":messageUpdate},
            function(datas){
                $('#message').html(datas);
        })
    })     
})
       // jquery clean message
        $('#btn2').click(function(){
            $('#message').html("");
         })     
    


})
</script>
{% endblock %}